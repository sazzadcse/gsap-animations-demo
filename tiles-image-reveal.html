<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Slice Reveal Animation</title>

	<!-- GSAP -->
	<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
	<script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>

	<style>
		* {
			box-sizing: border-box;
		}

		body {
			margin: 0;
			font-family: system-ui, sans-serif;
			overflow-x: hidden;
			background: #f5f5f5;
		}

		/* Control Panel Styles */
		.control-panel {
			position: fixed;
			top: 20px;
			right: 20px;
			width: 320px;
			background: white;
			border-radius: 12px;
			box-shadow: 0 10px 40px rgba(0,0,0,0.15);
			padding: 24px;
			z-index: 1000;
			max-height: 90vh;
			overflow-y: auto;
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		}

		.control-panel h3 {
			margin: 0 0 20px 0;
			font-size: 18px;
			color: #333;
			border-bottom: 2px solid #ff4c04;
			padding-bottom: 10px;
		}

		.control-group {
			margin-bottom: 20px;
		}

		.control-group label {
			display: block;
			font-size: 13px;
			font-weight: 600;
			color: #555;
			margin-bottom: 8px;
		}

		.control-group select,
		.control-group input[type="number"],
		.control-group input[type="text"] {
			width: 100%;
			padding: 10px;
			border: 2px solid #e0e0e0;
			border-radius: 6px;
			font-size: 14px;
			transition: border-color 0.3s;
		}

		.control-group select:focus,
		.control-group input[type="number"]:focus,
		.control-group input[type="text"]:focus {
			outline: none;
			border-color: #ff4c04;
		}

		.apply-btn {
			width: 100%;
			padding: 12px;
			background: #ff4c04;
			color: white;
			border: none;
			border-radius: 6px;
			font-size: 14px;
			font-weight: 600;
			cursor: pointer;
			transition: background 0.3s;
		}

		.apply-btn:hover {
			background: #e64400;
		}

		.control-group.hidden {
			display: none;
		}

		* {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		h1 {
			font-family: "Plus Jakarta Sans", sans-serif;
			font-size: 56px;
			font-weight: 800;
			line-height: 1.3;
			letter-spacing: -0.5px;
			color: #3c4043;
			text-align: center;
		}

		h1 span {
			color: #ff4c04;
		}

		h2 {
			font-family: "Plus Jakarta Sans", sans-serif;
			font-size: 32px;
			font-weight: 700;
			line-height: 40px;
			letter-spacing: -0.5px;
			color: #3c4043;
		}

		p {
			font-family: "Plus Jakarta Sans", sans-serif;
			font-size: 16px;
			font-weight: 300;
			line-height: 26px;
			margin-top: 16px;
			color: #3c4043;
		}

		.container {
			display: flex;
			width: 100%;
			max-width: 1180px;
			margin: auto;
			justify-content: space-between;
			align-items: center;
			gap: 80px;
			padding: 120px 40px;
		}

		.container .content--wrapper {
			width: 40%;
		}

		.container .content--wrapper .snippet--wrapper {
			background: #eef0f2;
			border-radius: 10px;
			font-family: "PT Mono", monospace;
			color: #ff4c04;
			padding: 16px;
			margin-top: 24px;
			font-size: 14px;
		}

		.container .image--wrapper {
			width: 50%;
		}

		#intro {
			justify-content: center;
			height: 100vh;
		}

		#intro .content--wrapper {
			width: 50%;
		}

		.section-label {
			background: #ff4c04;
			color: white;
			padding: 8px 16px;
			border-radius: 20px;
			font-size: 12px;
			font-weight: 600;
			text-transform: uppercase;
			letter-spacing: 1px;
			margin-bottom: 16px;
			display: inline-block;
		}

		.config-display {
			background: #f8f9fa;
			border: 1px solid #e9ecef;
			border-radius: 8px;
			padding: 12px;
			margin-top: 12px;
			font-size: 12px;
			color: #666;
		}

		.config-display strong {
			color: #333;
		}

		/* Slice Reveal Container */
		.slice-reveal {
			position: relative;
			width: 100%;
			height: 600px;
			overflow: hidden;
			background: #189eff;
		}

		.slice-reveal .slice {
			position: absolute;
			top: 0;
			left: 0;
			overflow: hidden;
			will-change: transform, clip-path;
		}

		.slice-reveal #sourceImage {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			object-fit: cover;
			opacity: 1;
			z-index: 1;
		}
	</style>

</head>

<body>

	<!-- Control Panel -->
	<div class="control-panel">
		<h3>⚙️ Slice Animation Config</h3>
		
		<div class="control-group">
			<label>Slice Direction</label>
			<select id="sliceDirection">
				<option value="horizontal" selected>Horizontal (Columns)</option>
				<option value="vertical">Vertical (Rows)</option>
			</select>
		</div>

		<div class="control-group">
			<label>Number of Slices</label>
			<input type="number" id="numSlices" value="3" min="2" max="20" step="1">
		</div>

		<div class="control-group">
			<label>Overlay Color</label>
			<input type="color" id="overlayColor" value="#189eff" style="width: 100%; height: 40px; padding: 2px; border: 2px solid #e0e0e0; border-radius: 6px; cursor: pointer;">
		</div>

		<div class="control-group">
			<label>Animation Trigger Point</label>
			<select id="triggerPoint">
				<option value="top top">Top Top</option>
				<option value="top center" selected>Top Center</option>
				<option value="top bottom">Top Bottom</option>
				<option value="center top">Center Top</option>
				<option value="center center">Center Center</option>
				<option value="center bottom">Center Bottom</option>
				<option value="bottom top">Bottom Top</option>
				<option value="bottom center">Bottom Center</option>
				<option value="bottom bottom">Bottom Bottom</option>
				<option value="custom">Custom</option>
			</select>
		</div>

		<div class="control-group" id="customTriggerGroup" style="display: none;">
			<label>Custom Trigger (start)</label>
			<input type="text" id="customTriggerStart" value="top 80%" placeholder="e.g., top 80%">
		</div>

		<div class="control-group">
			<label>Stagger Delay (seconds)</label>
			<input type="number" id="staggerDelay" value="0.25" step="0.05" min="0" max="2">
		</div>

		<div class="control-group">
			<label>Animation Duration (seconds)</label>
			<input type="number" id="animationDuration" value="0.8" step="0.1" min="0.1" max="5">
		</div>

		<div class="control-group">
			<label>Easing Function</label>
			<select id="easingFunction">
				<option value="power1.inOut">Power1 InOut</option>
				<option value="power2.inOut">Power2 InOut</option>
				<option value="power3.inOut">Power3 InOut</option>
				<option value="power4.inOut" selected>Power4 InOut</option>
				<option value="power2.out">Power2 Out (Smoother)</option>
				<option value="back.out">Back Out</option>
				<option value="elastic.out">Elastic Out</option>
				<option value="bounce.out">Bounce Out</option>
			</select>
		</div>

		<button class="apply-btn" onclick="applyConfiguration()">Apply Configuration</button>
	</div>

	<div id="intro" class="container">
		<div class="content--wrapper">
			<h1>Slice <span>Reveal</span> Animation</h1>
			<p>Configure the number of slices and direction to create stunning column-by-column or row-by-row reveal animations.</p>
		</div>
	</div>

	<!-- Demo Section -->
	<section class="container">
		<div class="content--wrapper">
			<span class="section-label">Demo</span>
			<h2>Slice Reveal Animation</h2>
			<div class="snippet--wrapper" id="snippet">.slice-reveal</div>
			<div class="config-display" id="configDisplay">
				<strong>Current Config:</strong> Direction: Horizontal, Slices: 3, Stagger: 0.25s, Duration: 0.8s
			</div>
		</div>
		<div class="image--wrapper">
			<div class="slice-reveal" id="sliceReveal">
				<img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=1400&fit=crop" alt="Demo Image" id="sourceImage">
			</div>
		</div>
	</section>

	<!-- Additional scroll space for testing -->
	<div style="height: 100vh;"></div>

	<script>
		// Register GSAP plugins
		gsap.registerPlugin(ScrollTrigger);

		// Global configuration object
		let config = {
			direction: 'horizontal',
			numSlices: 3,
			triggerPoint: 'top center',
			customTriggerStart: 'top 80%',
			staggerDelay: 0.25,
			duration: 0.8,
			easing: 'power4.inOut',
			overlayColor: '#189eff'
		};

		// Store ScrollTrigger instances for cleanup
		let scrollTriggers = [];

		// Get easing function from string
		function getEasing(easingString) {
			const easingMap = {
				'power1.inOut': 'power1.inOut',
				'power2.inOut': 'power2.inOut',
				'power3.inOut': 'power3.inOut',
				'power4.inOut': 'power4.inOut',
				'power2.out': 'power2.out',
				'back.out': 'back.out(1.7)',
				'elastic.out': 'elastic.out(1, 0.3)',
				'bounce.out': 'bounce.out'
			};
			return easingMap[easingString] || 'power4.inOut';
		}

		// Create slices based on direction and number
		function createSlices(container, sourceImage, direction, numSlices, overlayColor) {
			// Clear existing slices
			const existingSlices = container.querySelectorAll('.slice');
			existingSlices.forEach(slice => slice.remove());

			// Get container dimensions
			const containerWidth = container.offsetWidth;
			const containerHeight = container.offsetHeight;

			console.log('Container dimensions:', containerWidth, 'x', containerHeight);

			// Calculate slice dimensions
			let sliceWidth, sliceHeight;
			
			if (direction === 'horizontal') {
				// For horizontal: create columns
				sliceWidth = containerWidth / numSlices;
				sliceHeight = containerHeight;
			} else {
				// For vertical: create rows
				sliceWidth = containerWidth;
				sliceHeight = containerHeight / numSlices;
			}

			console.log('Slice dimensions:', sliceWidth, 'x', sliceHeight);

			// Create image slices
			for (let i = 0; i < numSlices; i++) {
				const slice = document.createElement('div');
				slice.className = 'slice';
				slice.dataset.index = i;

				// Set slice dimensions and position
				if (direction === 'horizontal') {
					slice.style.width = sliceWidth + 'px';
					slice.style.height = sliceHeight + 'px';
					slice.style.left = (i * sliceWidth) + 'px';
					slice.style.top = '0';
				} else {
					slice.style.width = sliceWidth + 'px';
					slice.style.height = sliceHeight + 'px';
					slice.style.left = '0';
					slice.style.top = (i * sliceHeight) + 'px';
				}

				// Set overlay color for this slice
				slice.style.background = overlayColor;
				slice.style.zIndex = '10';

				container.appendChild(slice);
			}

			console.log('Created', numSlices, 'slices with color:', overlayColor);
			return container.querySelectorAll('.slice');
		}

		// Apply slice animation
		function applySliceAnimation(container, slices, direction, triggerPoint, customTriggerStart, staggerDelay, duration, easing) {
			// Kill existing triggers
			scrollTriggers.forEach(tl => {
				if (tl) {
					if (tl.scrollTrigger) {
						tl.scrollTrigger.kill();
					}
					tl.kill();
				}
			});
			scrollTriggers = [];

			// Create timeline with ScrollTrigger
			const tl = gsap.timeline({
				scrollTrigger: {
					trigger: container,
					start: triggerPoint === 'custom' ? customTriggerStart : triggerPoint,
					end: 'bottom top',
					toggleActions: 'play none none none'
				}
			});

			// Store timeline for cleanup
			scrollTriggers.push(tl);

			// Set initial clipPath based on direction
			let initialClipPath, finalClipPath;

			if (direction === 'horizontal') {
				// For horizontal: columns disappear vertically (top to bottom)
				initialClipPath = 'inset(0 0 0 0)';
				finalClipPath = 'inset(0 0 100% 0)';
			} else {
				// For vertical: rows disappear horizontally (left to right)
				initialClipPath = 'inset(0 0 0 0)';
				finalClipPath = 'inset(0 100% 0 0)';
			}

			// Set initial state for all slices
			gsap.set(slices, {
				clipPath: initialClipPath
			});

			// Animate slices with stagger - each slice disappears one by one
			tl.to(slices, {
				clipPath: finalClipPath,
				duration: duration,
				ease: easing,
				stagger: {
					each: staggerDelay,
					from: 'start'
				}
			}, 0);

			console.log('Animation applied to', slices.length, 'slices');
			return tl;
		}

		// Main slice reveal function
		function sliceReveal() {
			const container = document.getElementById('sliceReveal');
			const sourceImage = document.getElementById('sourceImage');

			if (!container || !sourceImage) {
				console.error('Container or source image not found');
				return;
			}

			console.log('Starting slice reveal...');
			console.log('Container:', container);
			console.log('Source Image:', sourceImage);

			// Create slices
			const slices = createSlices(container, sourceImage, config.direction, config.numSlices, config.overlayColor);

			// Apply animation
			applySliceAnimation(
				container,
				slices,
				config.direction,
				config.triggerPoint,
				config.customTriggerStart,
				config.staggerDelay,
				config.duration,
				getEasing(config.easing)
			);

			// Force ScrollTrigger refresh
			setTimeout(() => {
				ScrollTrigger.refresh();
			}, 100);
		}

		// Apply configuration from control panel
		function applyConfiguration() {
			// Get values from control panel
			config.direction = document.getElementById('sliceDirection').value;
			config.numSlices = parseInt(document.getElementById('numSlices').value);
			config.triggerPoint = document.getElementById('triggerPoint').value;
			config.customTriggerStart = document.getElementById('customTriggerStart').value;
			config.staggerDelay = parseFloat(document.getElementById('staggerDelay').value);
			config.duration = parseFloat(document.getElementById('animationDuration').value);
			config.easing = document.getElementById('easingFunction').value;
			config.overlayColor = document.getElementById('overlayColor').value;

			// Validate numSlices
			if (config.numSlices < 2) config.numSlices = 2;
			if (config.numSlices > 20) config.numSlices = 20;

			console.log('New config:', config);

			// Re-run animations with new config
			sliceReveal();

			// Update config display
			updateConfigDisplay();
		}

		// Update config display text
		function updateConfigDisplay() {
			const element = document.getElementById('configDisplay');
			if (element) {
				const directionText = config.direction === 'horizontal' ? 'Horizontal (Columns)' : 'Vertical (Rows)';
				element.innerHTML = '<strong>Current Config:</strong> Direction: ' + directionText + ', Slices: ' + config.numSlices + ', Stagger: ' + config.staggerDelay + 's, Duration: ' + config.duration + 's';
			}

			// Update snippet
			const snippet = document.getElementById('snippet');
			if (snippet) {
				snippet.textContent = '.slice-reveal .slice:nth-child(' + config.numSlices + ')';
			}
		}

		// Show/hide custom trigger input
		document.getElementById('triggerPoint').addEventListener('change', function() {
			const customGroup = document.getElementById('customTriggerGroup');
			if (this.value === 'custom') {
				customGroup.style.display = 'block';
			} else {
				customGroup.style.display = 'none';
			}
		});

		// Initialize on page load - wait for image to load
		window.addEventListener('load', function() {
			const sourceImage = document.getElementById('sourceImage');
			
			// Wait for image to load
			if (sourceImage.complete) {
				sliceReveal();
				updateConfigDisplay();
			} else {
				sourceImage.addEventListener('load', function() {
					sliceReveal();
					updateConfigDisplay();
				});
			}
		});

		// Refresh on resize
		let resizeTimer;
		window.addEventListener('resize', function() {
			clearTimeout(resizeTimer);
			resizeTimer = setTimeout(function() {
				sliceReveal();
			}, 250);
		});
	</script>

</body>

</html>
